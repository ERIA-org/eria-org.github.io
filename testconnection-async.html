<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ERIA connection test (Senayan)</title>
</head>
<body>
  <h1>ERIA connection test (Senayan)</h1>
  <p>This test page is for those in Senayan office<br>
  Click on the button below to begin testing</p>
  <button id="pingButton">Test</button>
  <div id="result"></div>
  <p id="time"></p>

  <script>
    const pingButton = document.getElementById('pingButton');
    const resultElement = document.getElementById('result');
    const timeElement = document.getElementById('time');

    pingButton.addEventListener('click', async () => {
      timeElement.textContent = '';

      function ping(host, port, pong) {
        var started = new Date().getTime();
        var http = new XMLHttpRequest();

        http.open("GET", host + ":" + port, true);
        http.onreadystatechange = function() {
          if (http.readyState == 4) {
            var ended = new Date().getTime();
            var milliseconds = ended - started;

            if (pong != null) {
              pong(milliseconds);
            }
          }
        };
        try {
          http.send(null);
        } catch(exception) {
          // this is expected
        }
      }
      


function delay(milliseconds){
    return new Promise(resolve => {
        setTimeout(resolve, milliseconds);
    });
}


async function init(){
		
      fetch('https://ipapi.co/json/')
        .then(response => response.json())
        .then(data => {
          resultElement.innerHTML = "<br>ISP: " + data.org;
        })
        .catch(error => {
          console.error('<br>Error fetching ISP information:', error);
          resultElement.innerHTML = "ISP: Unknown (Error fetching ISP information: " + error + ")";
        });
	resultElement.innerHTML += "<br><br>";

    await delay(2000);

	resultElement.innerHTML += "<p>Test result: </p>";

      ping("http://192.168.0.1/login", "80", function(milliseconds) {
        resultElement.innerHTML += "ERIA (Senayan) router (http://192.168.0.1): " + milliseconds + "ms";
      });
      ping("http://192.168.0.1/login", "80", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("http://192.168.0.1/login", "80", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });

    await delay(2000);

      ping("https://www.linknet.co.id", "443", function(milliseconds) {
        resultElement.innerHTML += "Linknet (https://www.linknet.co.id): " + milliseconds + "ms";
      });
      ping("https://www.linknet.co.id", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("https://www.linknet.co.id", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });

    await delay(2000);

      ping("https://www.telkom.co.id", "443", function(milliseconds) {
        resultElement.innerHTML += "Telkom (https://www.telkom.co.id): " + milliseconds + "ms";
      });
      ping("https://www.telkom.co.id", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("https://www.telkom.co.id", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });


    await delay(2000);

      ping("https://www.biznetnetworks.com", "443", function(milliseconds) {
        resultElement.innerHTML += "Biznet (https://www.biznetnetworks.com): " + milliseconds + "ms";
      });
      ping("https://www.biznetnetworks.com", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("https://www.biznetnetworks.com", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });

    await delay(2000);

      ping("https://www.detik.com", "443", function(milliseconds) {
        resultElement.innerHTML += "Detik (https://www.detik.com): " + milliseconds +  "ms";
      });
      ping("https://www.detik.com", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("https://www.detik.com", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });

    await delay(2000);

      ping("https://internetbeacon.msedge.net", "443", function(milliseconds) {
        resultElement.innerHTML += "Microsoft (https://internetbeacon.msedge.net): " + milliseconds + "ms";
      });
      ping("https://internetbeacon.msedge.net", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("https://internetbeacon.msedge.net", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });

    await delay(2000);

      ping("https://www.google.com", "443", function(milliseconds) {
        resultElement.innerHTML += "Google (https://www.google.com): " + milliseconds + "ms";
      });
      ping("https://www.google.com", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms";
      });
      ping("https://www.google.com", "443", function(milliseconds) {
        resultElement.innerHTML += " " + milliseconds + "ms<br>";
      });

}

init();



    });
  </script>
</body>
</html>
